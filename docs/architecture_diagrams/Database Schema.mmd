// Tuxedo Link - Database Schema

// Users Table
users [icon: table, color: blue] {
  id [label: "id: INTEGER PK"]
  email [label: "email: TEXT UNIQUE"]
  password_hash [label: "password_hash: TEXT"]
  created_at [label: "created_at: DATETIME"]
  last_login [label: "last_login: DATETIME"]
}

// Alerts Table
alerts [icon: table, color: green] {
  aid [label: "id: INTEGER PK"]
  user_id [label: "user_id: INTEGER FK"]
  user_email [label: "user_email: TEXT"]
  profile_json [label: "profile_json: TEXT"]
  frequency [label: "frequency: TEXT"]
  last_sent [label: "last_sent: DATETIME"]
  active [label: "active: INTEGER"]
  created_at [label: "created_at: DATETIME"]
  last_match_ids [label: "last_match_ids: TEXT"]
}

// Cats Cache Table
cats_cache [icon: table, color: orange] {
  cid [label: "id: TEXT PK"]
  name [label: "name: TEXT"]
  breed [label: "breed: TEXT"]
  age [label: "age: TEXT"]
  gender [label: "gender: TEXT"]
  size [label: "size: TEXT"]
  organization_name [label: "organization_name: TEXT"]
  city [label: "city: TEXT"]
  state [label: "state: TEXT"]
  source [label: "source: TEXT"]
  url [label: "url: TEXT"]
  cat_json [label: "cat_json: TEXT"]
  fingerprint [label: "fingerprint: TEXT"]
  image_embedding [label: "image_embedding: BLOB"]
  is_duplicate [label: "is_duplicate: INTEGER"]
  duplicate_of [label: "duplicate_of: TEXT"]
  fetched_at [label: "fetched_at: DATETIME"]
  created_at [label: "created_at: DATETIME"]
}

// ChromaDB Collection
vector_collection [icon: database, color: purple] {
  cats_embeddings [label: "Collection: cats_embeddings"]
  embedding_dim [label: "Dimensions: 384"]
  model [label: "Model: all-MiniLM-L6-v2"]
  metadata [label: "Metadata: name, breed, age, etc."]
}

// Relationships
users > alerts: user_id
alerts > cats_cache: Search results
cats_cache > vector_collection: Embeddings